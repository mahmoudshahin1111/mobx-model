{"version":3,"file":"restful_actions_mixin.js","names":["_api","_interopRequireDefault","require","_base_model","_isString","_isFunction","BaseModel","addClassAction","attributes","_this","isString","name","API","request","method","data","endpoint","urlRoot","onSuccess","options","arguments","length","undefined","json","body","model","set","modelJson","jsonKey","topLevelJson","isFunction","afterCreate","id","isIncludeDeleted","_this2","concat","include_deleted","addAction","_this3","afterUpdate","_this4","onDestroy","afterDestroy"],"sources":["../src/restful_actions_mixin.js"],"sourcesContent":["import API from './api';\r\nimport BaseModel from './base_model';\r\n\r\nimport isString from 'lodash/isString';\r\nimport isFunction from 'lodash/isFunction';\r\n\r\n\r\nBaseModel.addClassAction('create', function(attributes) {\r\n\r\n  if (isString(attributes)) {\r\n    attributes = { name: attributes }\r\n  }\r\n\r\n  return API.request({\r\n    method: 'post',\r\n    data: attributes,\r\n    endpoint: this.urlRoot,\r\n    onSuccess: (options = {}) => {\r\n      const json = options.body;\r\n\r\n      let model = this.set({\r\n        modelJson: json[this.jsonKey],\r\n        topLevelJson: json\r\n      });\r\n\r\n      if (isFunction(model.afterCreate)) {\r\n        model.afterCreate(options);\r\n      }\r\n\r\n    }\r\n  });\r\n});\r\n\r\n\r\nBaseModel.addClassAction('load', function(id, isIncludeDeleted) {\r\n  return API.request({\r\n    endpoint: `${this.urlRoot}/${id}`,\r\n    data: {\r\n      include_deleted: isIncludeDeleted\r\n    },\r\n    onSuccess: (options = {}) => {\r\n      const json = options.body;\r\n\r\n      this.set({\r\n        modelJson: json[this.jsonKey],\r\n        topLevelJson: json\r\n      });\r\n\r\n    }\r\n  })\r\n});\r\n\r\n\r\nBaseModel.addAction('update', function(attributes = {}) {\r\n  return API.request({\r\n    method: 'put',\r\n    data: attributes,\r\n    endpoint: `${this.urlRoot}/${this.id}`,\r\n    onSuccess: (options = {}) => {\r\n      const json = options.body;\r\n\r\n      this.set({\r\n        modelJson: json[this.jsonKey],\r\n        topLevelJson: json\r\n      });\r\n\r\n      if (isFunction(this.afterUpdate)) {\r\n        this.afterUpdate(options);\r\n      }\r\n\r\n    }\r\n  });\r\n});\r\n\r\n\r\nBaseModel.addAction('destroy', function() {\r\n  return API.request({\r\n    method: 'del',\r\n    endpoint: `${this.urlRoot}/${this.id}`,\r\n    onSuccess: (options = {}) => {\r\n      this.onDestroy();\r\n\r\n      if (isFunction(this.afterDestroy)) {\r\n        this.afterDestroy(options);\r\n      }\r\n\r\n    }\r\n  });\r\n});\r\n\r\n"],"mappings":"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"}