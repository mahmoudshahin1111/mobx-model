{"version":3,"file":"base_model.js","names":["_mobx","require","_inflection","_filter","_interopRequireDefault","_uniqueId","_result","_init_attributes","_set_attributes","_init_relations","_set_relations","initObservables","target","observables","isObservableArray","collection","extendObservable","observable","array","deep","BaseModel","addClassAction","actionName","method","Object","defineProperty","get","bind","configurable","addAction","prototype","constructor","options","arguments","length","undefined","_defineProperty2","default","modelJson","topLevelJson","requestId","id","initAttributes","model","initRelations","onInitialize","set","uniqueId","lastSetRequestId","transaction","setAttributes","setRelations","urlRoot","jsonKey","onDestroy","removeSelfFromCollection","destroyDependentRelations","removeSelfFromRelations","remove","relationsToDestroy","filter","relations","relation","reverseRelation","forEach","isHasMany","propertyName","slice","relatedModel","isHasOne","relationsToRemoveFrom","removeMethodName","toJSON","attributes","attributeValues","keys","reduce","values","attributeName","relationValues","_ref","type","foreignKey","camelizedForeignKey","camelize","map","_this$observables","items","l","i","toString","push","splice","indexOf","_urlRoot","tableize","modelName","name","value","_jsonKey","underscore","_default","exports"],"sources":["../src/base_model.js"],"sourcesContent":["import {\r\n    transaction,\r\n    extendObservable,\r\n    isObservableArray,\r\n    observable\r\n} from \"mobx\";\r\nimport { tableize, underscore, camelize } from \"inflection\";\r\nimport filter from \"lodash/filter\";\r\nimport uniqueId from \"lodash/uniqueId\";\r\nimport result from \"lodash/result\";\r\n\r\nimport initAttributes from \"./init_attributes\";\r\nimport setAttributes from \"./set_attributes\";\r\nimport initRelations from \"./init_relations\";\r\nimport setRelations from \"./set_relations\";\r\n\r\n/*\r\n * This is a hack to allow each model that extends\r\n * BaseModel to have its own observable collection. Model is\r\n * assigned an observable collection when first instance of model is\r\n * created or when Model.all() method is called\r\n */\r\nconst initObservables = function(target) {\r\n    if (\r\n        !target.observables ||\r\n        !isObservableArray(target.observables.collection)\r\n    ) {\r\n        target.observables = {};\r\n        extendObservable(target.observables, {\r\n            collection: observable.array([],{deep:false})\r\n        });\r\n    }\r\n};\r\n\r\nclass BaseModel {\r\n    static attributes = {};\r\n    static relations = [];\r\n    // static observables = {};\r\n\r\n    id = null;\r\n    lastSetRequestId = null;\r\n\r\n    // static config = function(options = {}) {\r\n    //   let { models } = options;\r\n    //   this.models = models;\r\n    // };\r\n\r\n    /*\r\n   * NOTE: we access internal mobservable array of values to\r\n   * prevent notifying observers when we're just getting single\r\n   * value. This way we'll prevent re-rendering components displaying\r\n   * single model when collection changes\r\n   */\r\n    static get = function(id) {\r\n        let items = this.observables?.collection;\r\n        if (items && isObservableArray(items)) {\r\n            let l = items.length;\r\n            for (var i = 0; i < l; i++) {\r\n                if (items[i].id.toString() === id.toString()) return items[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    static set = function(options = {}) {\r\n        // console.log('set static', this.name)\r\n\r\n        let { modelJson, topLevelJson, requestId } = options;\r\n\r\n        /*\r\n      requestId is used to allow models to \r\n      prevent loops when setting same attributes\r\n      multiple times, we set one if none is set\r\n     */\r\n        if (!requestId) requestId = uniqueId(\"request_\");\r\n\r\n        /*\r\n     * topLevelJson is used to get json for models referenced by ids\r\n     */\r\n        if (!topLevelJson) topLevelJson = modelJson;\r\n\r\n        let model = this.get(modelJson.id);\r\n\r\n        transaction(() => {\r\n            if (!model) {\r\n                model = new this({\r\n                    modelJson,\r\n                    topLevelJson,\r\n                    requestId\r\n                });\r\n\r\n                this.observables.collection.push(model);\r\n            }\r\n\r\n            model.set({ modelJson, topLevelJson, requestId });\r\n        });\r\n\r\n        // console.log('set', model)\r\n\r\n        return model;\r\n    };\r\n\r\n    static remove = function(model) {\r\n        if (\r\n            this.observables &&\r\n            isObservableArray(this.observables.collection)\r\n        ) {\r\n            this.observables.collection.splice(\r\n                this.observables.collection.indexOf(model),\r\n                1\r\n            );\r\n        }\r\n    };\r\n\r\n    static all = function() {\r\n        initObservables(this);\r\n        return this.observables.collection.slice();\r\n    };\r\n\r\n    static addClassAction(actionName, method) {\r\n        Object.defineProperty(this, actionName, {\r\n            get: function() {\r\n                return method.bind(this);\r\n            },\r\n            configurable: true\r\n        });\r\n    }\r\n\r\n    static addAction(actionName, method) {\r\n        Object.defineProperty(this.prototype, actionName, {\r\n            get: function() {\r\n                return method.bind(this);\r\n            },\r\n            configurable: true\r\n        });\r\n    }\r\n\r\n    constructor(options = {}) {\r\n        let { modelJson, topLevelJson, requestId } = options;\r\n\r\n        initObservables(this.constructor);\r\n\r\n        if (modelJson && modelJson.id) {\r\n            this.id = modelJson.id;\r\n        }\r\n\r\n        initAttributes({ model: this });\r\n        initRelations({ model: this });\r\n\r\n        this.onInitialize();\r\n    }\r\n\r\n    set(options = {}) {\r\n        let { requestId, modelJson, topLevelJson } = options;\r\n        let model = this;\r\n\r\n        if (!requestId) requestId = uniqueId(\"request_\");\r\n\r\n        if (this.lastSetRequestId === requestId) {\r\n            return;\r\n        } else {\r\n            this.lastSetRequestId = requestId;\r\n        }\r\n\r\n        transaction(() => {\r\n            setAttributes({ model, modelJson });\r\n\r\n            setRelations({\r\n                model,\r\n                requestId,\r\n                modelJson,\r\n                topLevelJson\r\n            });\r\n        });\r\n    }\r\n\r\n    get urlRoot() {\r\n        return this.constructor.urlRoot;\r\n    }\r\n\r\n    get jsonKey() {\r\n        return this.constructor.jsonKey;\r\n    }\r\n\r\n    onInitialize() {}\r\n\r\n    onDestroy() {\r\n        transaction(() => {\r\n            this.removeSelfFromCollection();\r\n            this.destroyDependentRelations();\r\n            this.removeSelfFromRelations();\r\n        });\r\n    }\r\n\r\n    removeSelfFromCollection() {\r\n        this.constructor.remove(this);\r\n    }\r\n\r\n    destroyDependentRelations() {\r\n        let relationsToDestroy = filter(\r\n            this.constructor.relations,\r\n            relation => {\r\n                let reverseRelation = relation.reverseRelation;\r\n                return (\r\n                    reverseRelation &&\r\n                    reverseRelation.onDestroy === \"destroyRelation\"\r\n                );\r\n            }\r\n        );\r\n\r\n        relationsToDestroy.forEach(relation => {\r\n            if (relation.isHasMany) {\r\n                this[relation.propertyName].slice().forEach(relatedModel => {\r\n                    relatedModel.onDestroy();\r\n                });\r\n            } else if (relation.isHasOne) {\r\n                this[relation.propertyName].onDestroy();\r\n            }\r\n        });\r\n    }\r\n\r\n    removeSelfFromRelations() {\r\n        let relationsToRemoveFrom = filter(\r\n            this.constructor.relations,\r\n            relation => {\r\n                let reverseRelation = relation.reverseRelation;\r\n                return (\r\n                    reverseRelation &&\r\n                    reverseRelation.onDestroy === \"removeSelf\"\r\n                );\r\n            }\r\n        );\r\n\r\n        relationsToRemoveFrom.forEach(relation => {\r\n            let removeMethodName = relation.reverseRelation.removeMethodName;\r\n\r\n            if (relation.isHasMany) {\r\n                this[relation.propertyName].slice().forEach(relatedModel => {\r\n                    if (relatedModel[removeMethodName]) {\r\n                        relatedModel[removeMethodName](this);\r\n                    }\r\n                });\r\n            } else if (relation.isHasOne) {\r\n                // console.log(relation.propertyName, removeMethodName, this[relation.propertyName])\r\n                if (\r\n                    this[relation.propertyName] &&\r\n                    this[relation.propertyName][removeMethodName]\r\n                ) {\r\n                    this[relation.propertyName][removeMethodName](this);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    toJSON() {\r\n        const { id, constructor } = this;\r\n        const { attributes, relations } = constructor;\r\n\r\n        // collect attributes\r\n        const attributeValues = Object.keys(attributes || {}).reduce(\r\n            (values, attributeName) => {\r\n                values[attributeName] = this[attributeName];\r\n                return values;\r\n            },\r\n            {}\r\n        );\r\n\r\n        // collect relation models id\r\n        const relationValues = (relations || []).reduce(\r\n            (values, { type, propertyName, foreignKey }) => {\r\n                const camelizedForeignKey = camelize(foreignKey, true);\r\n\r\n                if (type === \"hasMany\") {\r\n                    values[camelizedForeignKey] = (this[propertyName] || [])\r\n                        .slice()\r\n                        .map(model => model.id);\r\n                }\r\n\r\n                if (type === \"hasOne\") {\r\n                    values[camelizedForeignKey] = (this[propertyName] || {}).id;\r\n                }\r\n\r\n                return values;\r\n            },\r\n            {}\r\n        );\r\n\r\n        return {\r\n            id,\r\n            ...attributeValues,\r\n            ...relationValues\r\n        };\r\n    }\r\n}\r\n\r\nObject.defineProperty(BaseModel, \"urlRoot\", {\r\n    get: function() {\r\n        return this._urlRoot\r\n            ? this._urlRoot\r\n            : \"/\" + tableize(this.modelName || this.name);\r\n    },\r\n    set: function(value) {\r\n        this._urlRoot = value;\r\n    },\r\n    configurable: true\r\n});\r\n\r\nObject.defineProperty(BaseModel, \"jsonKey\", {\r\n    get: function() {\r\n        return this._jsonKey\r\n            ? this._jsonKey\r\n            : underscore(this.modelName || this.name);\r\n    },\r\n    set: function(value) {\r\n        this._jsonKey = value;\r\n    },\r\n    configurable: true\r\n});\r\n\r\nexport default BaseModel;\r\n"],"mappings":"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"}